<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>积分榜</title>
</head>
<body>
	
</body>
<script type="text/javascript" src='data.js'></script>
<script type="text/javascript">
	// console.log(jh,'jh')
Hashtable = function() {
    this.items = new Array();
    this.itemsCount = 0;
    this.add = function(key, value) {
        if (!this.containsKey(key)) {
            this.items[key] = value;
            this.itemsCount++;
        }
        else {//重复赋值
            this.items[key] = value;
        }
    }
    this.get = function(key) {
        if (this.containsKey(key))
            return this.items[key];
        else
            return null;
    }

    this.keys = function() {
        var keys = new Array();
        for (var i in this.items) {
            if (this.items[i] != null)
                keys.push(i);
        }
        return keys;
    }

    this.values = function() {
        var values = new Array();
        for (var i in this.items) {
            if (this.items[i] != null)
                values.push(this.items[i]);
        }
        return values;
    }
    this.getOneValues = function(key) {
        var retval = 0;
        if (this.containsKey(key))
            retval = parseInt(this.items[key]);
        return retval;
    }
    this.remove = function(key) {
        if (this.containsKey(key)) {
            delete this.items[key];
            this.itemsCount--;
        }
    }
    this.containsKey = function(key) {
        return typeof (this.items[key]) != "undefined";

    }
    this.containsValue = function containsValue(value) {
        for (var item in this.items) {
            if (this.items[item] == value)
                return true;
            break;
        }
        return false;
    }

    this.contains = function(keyOrValue) {
        return this.containsKey(keyOrValue) || this.containsValue(keyOrValue);
    }
    this.clear = function() {
        this.items = new Array();
        itemsCount = 0;
    }
}
function cmp(a, b) {
    return b[14] == a[14] ? (a[8] == b[8] ? b[6] - a[6] : b[8] - a[8]) : b[14] - a[14];
}
function to2bits(flt, num) {
    if (flt != 0)
        return Math.round(flt * num) / num;
    else
        return 0.0;
}
function getScoreList(round, type) {//type 1:总积分榜;2:主场积分榜;3:客场积分榜;4:半场总积分榜;5:半场主场积分榜;6:半场客场积分榜
    var hs = new Hashtable();
    var scoreList = new Array(arrTeam.length);
    for (var k = 0; k < arrTeam.length; k++) {
        var teamid = arrTeam[k][0];
        for (var i = 1; i <= round; i++) {
            for (var j = 0; j < jh["R_" + i].length; j++) {
                if (jh["R_" + i][j][6].indexOf("-") == -1) continue; //推迟,取消的赛事不参与计算
                var scores = jh["R_" + i][j][6].split("-"); //全场比分
                var scoresHalf = jh["R_" + i][j][7].split("-"); //半场比分
                if (type == 4 || type == 5 || type == 6)
                    scores = scoresHalf;
                if (teamid == jh["R_" + i][j][4] && (type == 1 || type == 2 || type == 5 || type == 4))//主场
                {
                    if (scores[0] > scores[1]) {
                        if (hs.containsKey("win1_" + teamid))
                            hs.items["win1_" + teamid] = parseInt(hs.get("win1_" + teamid)) + 1;

                        else
                            hs.add("win1_" + teamid, 1);
                    }
                    else if (scores[0] == scores[1]) {
                        if (hs.containsKey("flat1_" + teamid))
                            hs.items["flat1_" + teamid] = parseInt(hs.get("flat1_" + teamid)) + 1;
                        else
                            hs.add("flat1_" + teamid, 1);
                    }
                    else {
                        if (hs.containsKey("fail1_" + teamid))
                            hs.items["fail1_" + teamid] = parseInt(hs.get("fail1_" + teamid)) + 1;
                        else
                            hs.add("fail1_" + teamid, 1);
                    }
                    if (hs.containsKey("homeScore1_" + teamid))//主场得
                        hs.items["homeScore1_" + teamid] = parseInt(hs.get("homeScore1_" + teamid)) + parseInt(scores[0]);
                    else
                        hs.add("homeScore1_" + teamid, scores[0]);
                    if (hs.containsKey("guestScore1_" + teamid))//主场失
                        hs.items["guestScore1_" + teamid] = parseInt(hs.get("guestScore1_" + teamid)) + parseInt(scores[1]);
                    else
                        hs.add("guestScore1_" + teamid, scores[1]);
                }
                else if (teamid == jh["R_" + i][j][5] && (type == 1 || type == 3 || type == 6 || type == 4))//客场
                {
                    if (scores[1] > scores[0]) {
                        if (hs.containsKey("win2_" + teamid))
                            hs.items["win2_" + teamid] = parseInt(hs.get("win2_" + teamid)) + 1;
                        else
                            hs.add("win2_" + teamid, 1);
                    }
                    else if (scores[1] == scores[0]) {
                        if (hs.containsKey("flat2_" + teamid))
                            hs.items["flat2_" + teamid] = parseInt(hs.get("flat2_" + teamid)) + 1;
                        else
                            hs.add("flat2_" + teamid, 1);
                    }
                    else {
                        if (hs.containsKey("fail2_" + teamid))
                            hs.items["fail2_" + teamid] = parseInt(hs.get("fail2_" + teamid)) + 1;
                        else
                            hs.add("fail2_" + teamid, 1);
                    }
                    if (hs.containsKey("homeScore2_" + teamid))//客场得
                        hs.items["homeScore2_" + teamid] = parseInt(hs.get("homeScore2_" + teamid)) + parseInt(scores[1]);
                    else
                        hs.add("homeScore2_" + teamid, scores[1]);
                    if (hs.containsKey("guestScore2_" + teamid))//客场失
                        hs.items["guestScore2_" + teamid] = parseInt(hs.get("guestScore2_" + teamid)) + parseInt(scores[0]);
                    else
                        hs.add("guestScore2_" + teamid, scores[0]);
                }
            }
        }
        scoreList[k] = new Array(13);
        if (type == 1 || type == 4) {//全场
            scoreList[k][3] = hs.getOneValues("win1_" + teamid) + hs.getOneValues("win2_" + teamid); //胜
            scoreList[k][4] = hs.getOneValues("flat1_" + teamid) + hs.getOneValues("flat2_" + teamid); //平
            scoreList[k][5] = hs.getOneValues("fail1_" + teamid) + hs.getOneValues("fail2_" + teamid); //负
            scoreList[k][6] = hs.getOneValues("homeScore1_" + teamid) + hs.getOneValues("homeScore2_" + teamid); //得
            scoreList[k][7] = hs.getOneValues("guestScore1_" + teamid) + hs.getOneValues("guestScore2_" + teamid); //失
        }
        else if (type == 2 || type == 5) {//主
            scoreList[k][3] = hs.getOneValues("win1_" + teamid);
            scoreList[k][4] = hs.getOneValues("flat1_" + teamid);
            scoreList[k][5] = hs.getOneValues("fail1_" + teamid);
            scoreList[k][6] = hs.getOneValues("homeScore1_" + teamid);
            scoreList[k][7] = hs.getOneValues("guestScore1_" + teamid);
        }
        else if (type == 3 || type == 6) {//客
            scoreList[k][3] = hs.getOneValues("win2_" + teamid);
            scoreList[k][4] = hs.getOneValues("flat2_" + teamid);
            scoreList[k][5] = hs.getOneValues("fail2_" + teamid);
            scoreList[k][6] = hs.getOneValues("homeScore2_" + teamid);
            scoreList[k][7] = hs.getOneValues("guestScore2_" + teamid);
        }
        scoreList[k][1] = teamid;
        scoreList[k][2] = scoreList[k][3] + scoreList[k][4] + scoreList[k][5]; //赛
        scoreList[k][8] = scoreList[k][6] - scoreList[k][7]; //净
        scoreList[k][9] = (scoreList[k][2] > 0 ? to2bits(scoreList[k][3] / scoreList[k][2] * 100, 10) : 0.0); //胜%
        scoreList[k][10] = (scoreList[k][2] > 0 ? to2bits(scoreList[k][4] / scoreList[k][2] * 100, 10) : 0.0); //平%
        scoreList[k][11] = (scoreList[k][2] > 0 ? to2bits(scoreList[k][5] / scoreList[k][2] * 100, 10) : 0.0); //负%
        scoreList[k][12] = (scoreList[k][2] > 0 ? to2bits(scoreList[k][6] / scoreList[k][2], 100) : 0.0); //均得
        scoreList[k][13] = (scoreList[k][2] > 0 ? to2bits(scoreList[k][7] / scoreList[k][2], 100) : 0.0); //均失
        scoreList[k][14] = scoreList[k][3] * 3 + scoreList[k][4]; //积分
    }
    hs.clear();
    scoreList.sort(cmp); //按积分,净,得降序排序
    for (var i = 0; i < scoreList.length; i++) {
        scoreList[i][0] = i + 1; //排名
    }
    // console.log(scoreList)
    return scoreList;
}
// getScoreList(1,1)
</script>
</html>